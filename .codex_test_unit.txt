
 RUN  v4.0.17 J:/amazong

 ✓ __tests__/format-price.test.ts (5 tests) 29ms
 ✓ __tests__/stripe-connect-fees.test.ts (4 tests) 279ms
 ✓ __tests__/i18n-messages-parity.test.ts (2 tests) 28ms
 ✓ __tests__/currency.test.ts (14 tests) 31ms
 ✓ __tests__/stripe-locale.test.ts (37 tests) 28ms
 ✓ __tests__/ai-model-spec.test.ts (5 tests) 83ms
 ✓ __tests__/api/products-newest-route.test.ts (2 tests) 252ms
 ✓ __tests__/checkout-webhook-idempotency.test.ts (1 test) 927ms
     ✓ upserts by stripe_payment_intent_id and avoids duplicate order_items  925ms
 ✓ __tests__/products-normalize.test.ts (2 tests) 893ms
 ✓ __tests__/proxy-middleware.test.ts (4 tests) 849ms
     ✓ sets x-pathname and geo cookies when missing  829ms
 ✓ __tests__/shipping.test.ts (45 tests) 14ms
 ✓ __tests__/order-status.test.ts (15 tests) 11ms
 ✓ __tests__/boost-status.test.ts (10 tests) 8ms
 ✓ __tests__/geolocation.test.ts (31 tests) 17ms
 ✓ __tests__/normalize-image-url.test.ts (23 tests) 10ms
 ✓ __tests__/validations-auth.test.ts (44 tests) 26ms
 ✓ __tests__/badge-intent.test.ts (8 tests) 8ms
 ✓ __tests__/mobile-tab-bar-routes.test.ts (5 tests) 8ms
 ✓ __tests__/supabase-middleware-session.test.ts (1 test) 8ms
 ✓ __tests__/guest-sell-cta.test.ts (8 tests) 8ms
 ✓ __tests__/url-utils.test.ts (7 tests) 6ms
 ✓ __tests__/category-tone.test.ts (5 tests) 7ms
 ✓ __tests__/home-browse-href.test.ts (5 tests) 8ms
 ✓ __tests__/active-filter-count.test.ts (5 tests) 5ms
 ✓ __tests__/image-utils.test.ts (8 tests) 8ms
 ✓ __tests__/env-parse-webhook-secrets.test.ts (5 tests) 6ms
 ✓ __tests__/home-pools.test.ts (2 tests) 5ms
 ✓ __tests__/safe-json.test.ts (3 tests) 5ms
stderr | __tests__/architecture-boundaries.test.ts > Architecture Boundaries > hooks/ should only contain client-side code (use client directive)
Advisory: 1 hook file(s) may need 'use client':
hooks\use-normalized-image-src.ts: exports React hooks but missing 'use client' directive

stderr | __tests__/architecture-boundaries.test.ts > Architecture Boundaries > server actions should validate input with Zod (boundary parsing)
Advisory: 2 server action file(s) may need Zod validation:
app\actions\boosts.ts: server action without Zod validation at boundary
app\actions\subscriptions-mutations.ts: server action without Zod validation at boundary

 ✓ __tests__/architecture-boundaries.test.ts (10 tests) 2709ms
     ✓ lib/ should not import from app/  914ms
     ✓ route-private directories (_components, _actions, _lib, _providers) should not be imported from outside their route  1128ms
     ✓ app/ and lib/ should not use supabase.auth.getSession()  329ms
 ✓ __tests__/proxy-matcher.test.ts (1 test) 4ms

 Test Files  30 passed (30)
      Tests  317 passed (317)
   Start at  19:53:29
   Duration  4.12s (transform 5.18s, setup 9.94s, import 5.36s, tests 6.28s, environment 7ms)


 RUN  v4.0.17 J:/amazong

 ✓ __tests__/hooks/use-is-mobile.test.ts (10 tests) 78ms
 ✓ __tests__/hooks/use-toast.test.ts (19 tests) 71ms
 ✓ __tests__/hooks/use-recently-viewed.test.ts (16 tests) 80ms
 ✓ __tests__/hooks/use-product-search.test.ts (26 tests) 96ms
stderr | __tests__/hooks/use-badges.test.ts > hooks/use-badges > initial fetch > handles network error
Error fetching badges: Error: Network error
    at J:/amazong/__tests__/hooks/use-badges.test.ts:82:39
    at file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///J:/amazong/node_modules/.pnpm/vitest@4.0.17_@opentelemetry+api@1.9.0_@types+node@25.0.9_jiti@2.6.1_jsdom@27.4.0_lightningcs_mrdpisxfnuylqgx3chnuxfrvha/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///J:/amazong/node_modules/.pnpm/vitest@4.0.17_@opentelemetry+api@1.9.0_@types+node@25.0.9_jiti@2.6.1_jsdom@27.4.0_lightningcs_mrdpisxfnuylqgx3chnuxfrvha/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///J:/amazong/node_modules/.pnpm/@vitest+runner@4.0.17/node_modules/@vitest/runner/dist/index.js:1653:12)

 ✓ __tests__/hooks/use-home-discovery-feed.test.ts (8 tests) 705ms
stderr | __tests__/hooks/use-badges.test.ts > hooks/use-badges > toggleFeatured > throws error on failed toggle
Error toggling badge feature: Error: Max featured badges reached
    at Object.toggleFeatured (J:/amazong/app/[locale]/(account)/account/_components/use-badges.ts:73:15)
    at J:/amazong/__tests__/hooks/use-badges.test.ts:250:11

stderr | __tests__/hooks/use-badges.test.ts > hooks/use-badges > toggleFeatured > throws clear error when toggle response shape is invalid
Error toggling badge feature: Error: Invalid badge feature response: expected { is_featured: boolean }
    at Object.toggleFeatured (J:/amazong/app/[locale]/(account)/account/_components/use-badges.ts:79:15)
    at J:/amazong/__tests__/hooks/use-badges.test.ts:274:11

stderr | __tests__/hooks/use-badges.test.ts > hooks/use-badges > evaluateBadges > returns empty array on error
Error evaluating badges: Error: Failed to evaluate badges
    at Object.evaluateBadges (J:/amazong/app/[locale]/(account)/account/_components/use-badges.ts:109:15)
    at J:/amazong/__tests__/hooks/use-badges.test.ts:389:22

 ✓ __tests__/hooks/use-badges.test.ts (16 tests) 1089ms
 ✓ __tests__/hooks/use-geo-welcome.test.ts (21 tests) 1214ms

 Test Files  7 passed (7)
      Tests  116 passed (116)
   Start at  19:53:35
   Duration  3.31s (transform 1.13s, setup 1.15s, import 3.74s, tests 3.33s, environment 7.42s)


 RUN  v4.0.17 J:/amazong

 ✓ __tests__/order-items-section.test.tsx (2 tests) 92ms
 ✓ __tests__/product-price.test.tsx (2 tests) 143ms
 ✓ __tests__/product-card-price.test.tsx (3 tests) 148ms
 ✓ __tests__/category-badge.test.tsx (2 tests) 143ms
stderr | __tests__/product-card-mini.test.tsx > ProductMiniCard > renders stable title, price, and link when href is provided
Received `true` for a non-boolean attribute `fill`.

If you want to write it to the DOM, pass a string instead: fill="true" or fill={value.toString()}.
Received `false` for a non-boolean attribute `prefetch`.

If you want to write it to the DOM, pass a string instead: prefetch="false" or prefetch={value.toString()}.

If you used to conditionally omit it with prefetch={condition && value}, pass prefetch={condition ? value : undefined} instead.

 ✓ __tests__/filter-checkbox-item.test.tsx (3 tests) 588ms
     ✓ toggles off when checked  402ms
 ✓ __tests__/product-card-mini.test.tsx (3 tests) 566ms
     ✓ renders stable title, price, and link when href is provided  533ms
 ✓ __tests__/filter-rating-section.test.tsx (3 tests) 746ms
     ✓ clears active rating when selected row is toggled  427ms
 ✓ __tests__/cart-badge-count.test.tsx (4 tests) 153ms
 ✓ __tests__/auth-login-form-body.test.tsx (2 tests) 547ms
     ✓ keeps submit disabled until email and password are valid  307ms
stderr | __tests__/product-card-mobile.test.tsx > MobileProductCard > renders seller-only row and dedicated price meta row with freshness + price badge
Received `false` for a non-boolean attribute `prefetch`.

If you want to write it to the DOM, pass a string instead: prefetch="false" or prefetch={value.toString()}.

If you used to conditionally omit it with prefetch={condition && value}, pass prefetch={condition ? value : undefined} instead.
Received `true` for a non-boolean attribute `fill`.

If you want to write it to the DOM, pass a string instead: fill="true" or fill={value.toString()}.
React does not recognize the `blurDataURL` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `blurdataurl` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
Received `true` for a non-boolean attribute `priority`.

If you want to write it to the DOM, pass a string instead: priority="true" or priority={value.toString()}.

 ✓ __tests__/product-card-mobile.test.tsx (1 test) 339ms
     ✓ renders seller-only row and dedicated price meta row with freshness + price badge  336ms
stderr | __tests__/product-card-desktop.test.tsx > DesktopProductCard > renders desktop price, trust metadata, and link selector
Received `false` for a non-boolean attribute `prefetch`.

If you want to write it to the DOM, pass a string instead: prefetch="false" or prefetch={value.toString()}.

If you used to conditionally omit it with prefetch={condition && value}, pass prefetch={condition ? value : undefined} instead.
Received `true` for a non-boolean attribute `fill`.

If you want to write it to the DOM, pass a string instead: fill="true" or fill={value.toString()}.
React does not recognize the `blurDataURL` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `blurdataurl` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
Received `true` for a non-boolean attribute `priority`.

If you want to write it to the DOM, pass a string instead: priority="true" or priority={value.toString()}.

 ✓ __tests__/product-card-desktop.test.tsx (1 test) 344ms
     ✓ renders desktop price, trust metadata, and link selector  341ms
 ✓ __tests__/product-grid-preset.test.tsx (3 tests) 53ms

 Test Files  12 passed (12)
      Tests  29 passed (29)
   Start at  19:53:40
   Duration  6.24s (transform 5.16s, setup 3.72s, import 16.70s, tests 3.86s, environment 21.31s)

