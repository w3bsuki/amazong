/* ============================================================
   ANIMATION UTILITIES
   
   @utility classes for loading states, transitions, and
   micro-interactions. Uses existing keyframes from effects.css.
   
   Categories:
   - Skeleton loading
   - Shimmer effects
   - Toast/notification animations
   - Modal/dialog transitions
   - Tab indicators
   - Micro-interactions
   ============================================================ */

/* ===== SKELETON LOADING ===== */

/* Base skeleton - solid color with pulse animation (no gradients) */
@utility skeleton {
  @apply relative overflow-hidden;
  @apply bg-muted;
  @apply rounded;
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}

@keyframes skeleton-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Skeleton text line */
@utility skeleton-text {
  @apply skeleton;
  @apply h-4 w-full;
  @apply rounded;
}

/* Skeleton heading */
@utility skeleton-heading {
  @apply skeleton;
  @apply h-6 w-3/4;
  @apply rounded;
}

/* Skeleton avatar */
@utility skeleton-avatar {
  @apply skeleton;
  @apply rounded-full;
  @apply w-10 h-10;
}

@utility skeleton-avatar-sm {
  @apply skeleton;
  @apply rounded-full;
  @apply w-8 h-8;
}

@utility skeleton-avatar-lg {
  @apply skeleton;
  @apply rounded-full;
  @apply w-16 h-16;
}

/* Skeleton button */
@utility skeleton-button {
  @apply skeleton;
  @apply h-10 w-24;
  @apply rounded-full;
}

/* Skeleton image/thumbnail */
@utility skeleton-image {
  @apply skeleton;
  @apply aspect-square w-full;
  @apply rounded-lg;
}

/* Skeleton card (product card placeholder) */
@utility skeleton-card {
  @apply skeleton;
  @apply rounded-xl;
  @apply h-64 w-full;
}

/* Skeleton badge */
@utility skeleton-badge {
  @apply skeleton;
  @apply h-5 w-16;
  @apply rounded-full;
}

/* Skeleton price */
@utility skeleton-price {
  @apply skeleton;
  @apply h-6 w-20;
  @apply rounded;
}

/* ===== SHIMMER EFFECTS ===== */

/* Shimmer - subtle shine effect for loading states */
@utility shimmer {
  @apply relative overflow-hidden;
}

@utility shimmer::after {
  content: '';
  @apply absolute inset-0;
  @apply pointer-events-none;
  @apply bg-foreground/5;
  animation: shimmer-sweep 2s ease-in-out infinite;
  transform: translateX(-100%);
}

@keyframes shimmer-sweep {
  100% {
    transform: translateX(100%);
  }
}

/* Shimmer button - loading state overlay */
@utility shimmer-button {
  @apply relative overflow-hidden;
}

@utility shimmer-button::after {
  content: '';
  @apply absolute inset-0;
  @apply pointer-events-none;
  @apply bg-foreground/5;
  animation: shimmer-sweep 1.5s ease-in-out infinite;
  transform: translateX(-100%);
}

/* ===== PULSE ANIMATIONS ===== */

/* Gentle pulse for loading/live indicators */
@utility animate-pulse-gentle {
  animation: pulse-gentle 2s ease-in-out infinite;
}

@keyframes pulse-gentle {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* Fast pulse for urgent notifications */
@utility animate-pulse-fast {
  animation: pulse-fast 1s ease-in-out infinite;
}

@keyframes pulse-fast {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

/* Ring pulse (notification dot) */
@utility animate-pulse-ring {
  animation: pulse-ring 1.5s ease-out infinite;
}

@keyframes pulse-ring {
  0% {
    box-shadow: 0 0 0 0 oklch(0.62 0.19 243 / 50%);
  }
  100% {
    box-shadow: 0 0 0 8px oklch(0.62 0.19 243 / 0%);
  }
}

/* ===== TOAST/NOTIFICATION ANIMATIONS ===== */

/* Toast enter from top */
@utility animate-toast-enter {
  animation: toast-enter 0.3s ease-out forwards;
}

@keyframes toast-enter {
  from {
    opacity: 0;
    transform: translateY(-100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Toast enter from bottom (mobile) */
@utility animate-toast-enter-bottom {
  animation: toast-enter-bottom 0.3s ease-out forwards;
}

@keyframes toast-enter-bottom {
  from {
    opacity: 0;
    transform: translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Toast exit */
@utility animate-toast-exit {
  animation: toast-exit 0.2s ease-in forwards;
}

@keyframes toast-exit {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
}

/* Toast slide-out right (swipe dismiss) */
@utility animate-toast-slide-out {
  animation: toast-slide-out 0.2s ease-in forwards;
}

@keyframes toast-slide-out {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100%);
  }
}

/* ===== MODAL/DIALOG ANIMATIONS ===== */

/* Modal backdrop fade */
@utility animate-backdrop-enter {
  animation: backdrop-enter 0.2s ease-out forwards;
}

@keyframes backdrop-enter {
  from { opacity: 0; }
  to { opacity: 1; }
}

@utility animate-backdrop-exit {
  animation: backdrop-exit 0.15s ease-in forwards;
}

@keyframes backdrop-exit {
  from { opacity: 1; }
  to { opacity: 0; }
}

/* Modal content scale + fade */
@utility animate-modal-enter {
  animation: modal-enter 0.25s ease-out forwards;
}

@keyframes modal-enter {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@utility animate-modal-exit {
  animation: modal-exit 0.2s ease-in forwards;
}

@keyframes modal-exit {
  from {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
  to {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
  }
}

/* Bottom sheet (mobile modal) */
@utility animate-sheet-enter {
  animation: sheet-enter 0.3s ease-out forwards;
}

@keyframes sheet-enter {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}

@utility animate-sheet-exit {
  animation: sheet-exit 0.25s ease-in forwards;
}

@keyframes sheet-exit {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(100%);
  }
}

/* ===== DROPDOWN/POPOVER ANIMATIONS ===== */

@utility animate-dropdown-enter {
  animation: dropdown-enter 0.15s ease-out forwards;
}

@keyframes dropdown-enter {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@utility animate-dropdown-exit {
  animation: dropdown-exit 0.1s ease-in forwards;
}

@keyframes dropdown-exit {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-4px);
  }
}

/* Popover with scale origin */
@utility animate-popover-enter {
  animation: popover-enter 0.15s ease-out forwards;
  transform-origin: var(--popover-origin, top center);
}

@keyframes popover-enter {
  from {
    opacity: 0;
    transform: scale(0.96);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* ===== TAB ANIMATIONS ===== */

/* Tab indicator slide */
@utility tab-indicator {
  @apply absolute bottom-0 left-0;
  @apply h-0.5 bg-primary;
  @apply transition-all duration-200 ease-out;
}

/* Tab content fade */
@utility animate-tab-enter {
  animation: tab-enter 0.2s ease-out forwards;
}

@keyframes tab-enter {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@utility animate-tab-exit {
  animation: tab-exit 0.15s ease-in forwards;
}

@keyframes tab-exit {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(-8px);
  }
}

/* ===== MICRO-INTERACTIONS ===== */

/* Button press effect */
@utility animate-press {
  @apply transition-transform duration-100;
  @apply active:scale-95;
}

/* Card hover lift */
@utility animate-lift {
  @apply transition-all duration-200;
  @apply hover:-translate-y-0.5 hover:shadow-card-hover;
}

/* Icon spin (loading) */
@utility animate-spin-slow {
  animation: spin 2s linear infinite;
}

@utility animate-spin-fast {
  animation: spin 0.5s linear infinite;
}

/* Bounce on appear */
@utility animate-bounce-in {
  animation: bounce-in 0.4s ease-out forwards;
}

@keyframes bounce-in {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    transform: scale(1);
  }
}

/* Success checkmark appear */
@utility animate-check {
  animation: check-appear 0.3s ease-out forwards;
}

@keyframes check-appear {
  from {
    stroke-dashoffset: 24;
  }
  to {
    stroke-dashoffset: 0;
  }
}

/* Heart/like animation */
@utility animate-heart {
  animation: heart-beat 0.35s ease-in-out;
}

@keyframes heart-beat {
  0% { transform: scale(1); }
  25% { transform: scale(1.3); }
  50% { transform: scale(1); }
  75% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

/* Add to cart pop */
@utility animate-cart-add {
  animation: cart-add 0.4s ease-out forwards;
}

@keyframes cart-add {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
  }
}

/* Number count up */
@utility animate-count {
  animation: count-up 0.3s ease-out forwards;
}

@keyframes count-up {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ===== LOADING STATES ===== */

/* Three-dot loading */
@utility loading-dots {
  @apply inline-flex items-center gap-1;
}

@utility loading-dot {
  @apply w-1.5 h-1.5 rounded-full bg-current;
  animation: loading-dot 1.4s ease-in-out infinite both;
}

@utility loading-dot:nth-child(1) {
  animation-delay: -0.32s;
}

@utility loading-dot:nth-child(2) {
  animation-delay: -0.16s;
}

@keyframes loading-dot {
  0%, 80%, 100% {
    transform: scale(0.6);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Spinner (circle) */
@utility spinner {
  @apply w-5 h-5;
  @apply border-2 border-current border-t-transparent;
  @apply rounded-full;
  animation: spin 0.75s linear infinite;
}

@utility spinner-sm {
  @apply w-4 h-4;
  @apply border-2 border-current border-t-transparent;
  @apply rounded-full;
  animation: spin 0.75s linear infinite;
}

@utility spinner-lg {
  @apply w-8 h-8;
  @apply border-3 border-current border-t-transparent;
  @apply rounded-full;
  animation: spin 0.75s linear infinite;
}

/* Progress bar animation */
@utility progress-indeterminate {
  @apply relative overflow-hidden;
  @apply h-1 w-full bg-muted rounded-full;
}

@utility progress-indeterminate::after {
  content: '';
  @apply absolute top-0 left-0 h-full;
  @apply w-1/3 bg-primary rounded-full;
  animation: progress-indeterminate 1.5s ease-in-out infinite;
}

@keyframes progress-indeterminate {
  0% {
    left: -33%;
  }
  100% {
    left: 100%;
  }
}

/* ===== REDUCED MOTION ===== */

@media (prefers-reduced-motion: reduce) {
  .skeleton,
  .shimmer,
  [class*="animate-"] {
    animation: none !important;
    transition: none !important;
  }
  
  .skeleton {
    background: oklch(0.92 0 0);
  }
  
  .dark .skeleton {
    background: oklch(0.25 0 0);
  }
}
